## 限流器

### 介绍

对某个接口单位时间内的访问量的限制作用

### 作用

拒绝超过服务器承载能力的流量

### 实现逻辑

1. 创建一个固定大小的桶（令牌）
2. 按一定速率对桶里面的令牌进行补充
3. 每进行一次访问，减少桶里现有的令牌数
4. 令牌最多补充到桶的大小

### 实现难点
1. 怎么实现gin的中间件
## 断路器

### 介绍

当服务连续报错，超过一定阈值，打开断路器使得服务不可用

### 作用

防止在服务不可用的情况下造成雪崩效应

### 实现逻辑

1. 时间周期（单位时间），记录连续的成功次数和连续的失败次数
2. 判断单位时间内连续的成功次数或连续的失败次数，是否达到了阈值
3. 失败达到阈值，断路器由闭合状态转为打开状态，下一个单位时间不让访问
4. 当打开状态持续一个单位时间，将打开状态转为半开状态，有限制的访问
5. 半开状态下，连续成功次数达到阈值，则转为关闭状态

### 实现难点
1. 如何获取函数的执行状态？
    > 定义了一个`func() error`的请求参数
2. 如何将该断路器嵌入到gin中？

## 补充
第三方工具
1. go-kit